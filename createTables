DROP TABLE referees CASCADE CONSTRAINTS;
DROP TABLE league CASCADE CONSTRAINTS;
DROP TABLE clubs CASCADE CONSTRAINTS;
DROP TABLE stadium CASCADE CONSTRAINTS;
DROP TABLE managers CASCADE CONSTRAINTS;
DROP TABLE players CASCADE CONSTRAINTS;
DROP TABLE matchess CASCADE CONSTRAINTS;
DROP TABLE matchesPlayed CASCADE CONSTRAINTS;



CREATE TABLE referees (
        ref_id         VARCHAR2(2 CHAR),
        ref_name       VARCHAR2(30 CHAR) NOT NULL,
        CONSTRAINT ref_pk PRIMARY KEY (ref_id)
        
);

CREATE TABLE league (
    country         VARCHAR2(30 CHAR),
    leagueName      VARCHAR2(30 CHAR) NOT NULL,
    CONSTRAINT country_pk PRIMARY KEY (country)
);

CREATE TABLE clubs (
    club_id               VARCHAR2(2 CHAR),
    c_name                VARCHAR2(30 CHAR) NOT NULL,
    home_jersey_color     VARCHAR2(30 CHAR),
    away_jersey_color     VARCHAR2(30 CHAR),
    country_fk             VARCHAR2(30 CHAR), --fk
    CONSTRAINT  clubid_pk PRIMARY KEY (club_id)
);
--ADD after i create league table to show relatioship
ALTER TABLE clubs 
ADD FOREIGN KEY (country_fk) REFERENCES league(country);

CREATE TABLE stadium (
        club_id               VARCHAR2(2 CHAR) PRIMARY KEY, --same key as club
        stadium_name          VARCHAR2(30 CHAR) NOT NULL,
        city                  VARCHAR2(30 CHAR) NOT NULL,
        CONSTRAINT clubid_fk FOREIGN KEY (club_id) REFERENCES clubs(club_id)
        
);

CREATE TABLE managers (
    manager_id   VARCHAR2(2 CHAR),
    m_name      VARCHAR2(30 CHAR) NOT NULL,
    age         NUMBER,
    clubid_fk    VARCHAR2(2 CHAR), --fk
    CONSTRAINT  managerid_pk PRIMARY KEY (manager_id)
);
--ADD after i create club to show relatioship
ALTER TABLE managers 
ADD FOREIGN KEY (clubid_fk) REFERENCES clubs(club_id);

CREATE TABLE players (
    player_id   VARCHAR2(2 CHAR),
    p_name      VARCHAR2(30 CHAR) NOT NULL,
    age         NUMBER,
    p_position  VARCHAR2(2 CHAR),
    shirt_#     NUMBER CHECK (shirt_# >=0 AND shirt_# <=99),
    managerid_fk  VARCHAR2(2 CHAR), --fk
    club_fk     VARCHAR2(2 CHAR), --fk
    CONSTRAINT  player_pk PRIMARY KEY (player_id)
);

-- ADD after i create manager and club to show relatioship
ALTER TABLE players
ADD FOREIGN KEY (managerid_fk) REFERENCES managers(manager_id)
ADD FOREIGN KEY (club_fk) REFERENCES clubs(club_id);


CREATE TABLE matchess (
        match_id    VARCHAR2(2 CHAR),
        GameDay     DATE,
        fk_gameRef  VARCHAR2(2 CHAR) NOT NULL,
        FOREIGN KEY (fk_gameRef) REFERENCES referees(ref_id),
        CONSTRAINT uc_ref_for_game  UNIQUE (fk_gameRef,GameDay),
        CONSTRAINT match_pk PRIMARY KEY (match_id)
        --NO REF CAN REFEREE 2 GAMES ONE DAY
        );
        
CREATE TABLE matchesPlayed (
            fk_match_id     VARCHAR2(2 CHAR) NOT NULL,
            fk_club_home    VARCHAR2(2 CHAR) NOT NULL,
            fk_club_away    VARCHAR2(2 CHAR) NOT NULL,
            FOREIGN KEY (fk_match_id) REFERENCES matchess(match_id ),
            FOREIGN KEY (fk_club_home) REFERENCES clubs(club_id),
            FOREIGN KEY (fk_club_away) REFERENCES clubs(club_id),
            CHECK (fk_club_home != fk_club_away),
            CONSTRAINT games UNIQUE (fk_match_id)
        );
